<div th:replace="~{layout/main :: layout(~{::section})}" xmlns:th="http://www.thymeleaf.org">
    <section>
        <div class="container" style="max-width: 900px; margin: 0 auto;">
            <div class="card" style="padding: 32px;">
                <div class="grid cols-2" style="gap: 24px; align-items: start;">
                    <!-- Left: Profile form -->
                    <div>
                        <div style="margin-bottom: 16px;">
                            <h2 class="h1" style="margin: 0;">My Profile</h2>
                            <p class="muted">Manage your account settings</p>
                        </div>

                        <div th:if="${successMessage}" class="badge success" style="margin-bottom:12px;" th:text="${successMessage}">Saved</div>
                        <div th:if="${errorMessage}" class="badge canceled" style="margin-bottom:12px;" th:text="${errorMessage}">Error</div>

                        <form class="form" method="post" th:action="@{/profile}" th:object="${updateRequest}">
                            <div>
                                <label for="username">ðŸ‘¤ Username</label>
                                <input id="username" type="text" th:value="${profile.username}" readonly>
                            </div>
                            <div>
                                <label for="email">ðŸ“§ Email Address</label>
                                <input id="email" type="email" th:field="*{email}" placeholder="your.email@example.com" required>
                                <div class="muted" th:if="${#fields.hasErrors('email')}" th:errors="*{email}">Invalid email</div>
                            </div>
                            <button class="btn btn-primary" type="submit" style="width: 100%;">ðŸ’¾ Save Changes</button>
                        </form>
                    </div>

                    <!-- Right: Stats -->
                    <div>
                        <h3 class="h2" style="margin-bottom: 12px;">ðŸ“Š Account Overview</h3>
                        <div class="grid cols-2" style="gap: 12px;">
                            <div class="card" style="padding: 12px;">
                                <div class="muted">Member Since</div>
                                <div class="h3" th:text="${profile.memberSince}">-</div>
                            </div>
                            <div class="card" style="padding: 12px;">
                                <div class="muted">Roles</div>
                                <div th:text="${profile.roles != null ? #strings.listJoin(profile.roles, ', ') : '-'}">-</div>
                            </div>
                            <div class="card" style="padding: 12px;">
                                <div class="muted">Total Trades</div>
                                <div class="h3" th:text="${profile.totalTrades}">0</div>
                            </div>
                            <div class="card" style="padding: 12px;">
                                <div class="muted">Open Positions</div>
                                <div class="h3" th:text="${profile.openPositions}">0</div>
                            </div>
                            <div class="card" style="padding: 12px;">
                                <div class="muted">Cash Balance</div>
                                <div class="h3" th:text="${#numbers.formatDecimal(profile.cashBalance, 1, 'POINT', 2, 'POINT')}">$0.00</div>
                            </div>
                            <div class="card" style="padding: 12px;">
                                <div class="muted">Account Value</div>
                                <div class="h3" th:text="${#numbers.formatDecimal(profile.accountValue, 1, 'POINT', 2, 'POINT')}">$0.00</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>

