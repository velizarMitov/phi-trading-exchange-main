<div th:replace="~{layout/main :: layout(~{::section})}" xmlns:th="http://www.thymeleaf.org">
    <section>
        <h2 class="h1 mb-4">üìà Buy Stocks</h2>

        <div th:if="${success}" class="alert success" th:text="${success}"></div>
        <div th:if="${error}" class="alert danger" th:text="${error}"></div>

        <div class="grid cols-2">
            <div class="card">
                <h3 class="h2 mb-3">Place Order</h3>
                <form class="form" method="post" th:action="@{/trade/buy}" th:object="${form}">
                    <div>
                        <label for="symbol">üìä Stock Symbol</label>
                        <div style="display:flex; gap:8px; align-items:center;">
                            <select id="symbol" class="input" th:field="*{symbol}" required>
                                <option value="" th:selected="${selectedSymbol == null}">Select a symbol</option>
                                <option th:each="ins : ${instruments}"
                                        th:value="${ins.symbol}"
                                        th:selected="${#strings.equalsIgnoreCase(ins.symbol, selectedSymbol)}"
                                        th:text="${ins.symbol} + ' ‚Äì ' + ${ins.name} + ' (' + ${#numbers.formatDecimal(ins.lastPrice, 1, 'POINT', 2, 'POINT')} + ')'">
                                    AAPL ‚Äì Apple Inc. (150.00)
                                </option>
                            </select>
                            <a class="btn" th:href="@{/trade/buy(symbol=${form.symbol})}">Load</a>
                        </div>
                        <div class="text-error" th:if="${#fields.hasErrors('symbol')}" th:errors="*{symbol}"></div>
                    </div>
                    <div>
                        <label for="quantity">üì¶ Quantity</label>
                        <input id="quantity" th:field="*{quantity}" type="number" step="1" min="1" placeholder="Enter number of shares" required>
                        <div class="text-error" th:if="${#fields.hasErrors('quantity')}" th:errors="*{quantity}"></div>
                    </div>
                    <button class="btn btn-primary" type="submit" style="width: 100%; margin-top: 8px;">üöÄ Execute Buy Order</button>
                </form>
            </div>

            <div class="card" style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.05), rgba(118, 75, 162, 0.05));">
                <h3 class="h2 mb-3">‚ÑπÔ∏è Instrument Info</h3>
                <div th:if="${selectedSymbol != null}" class="mb-2">
                    <div class="muted">Selected</div>
                    <div class="h2" th:text="${selectedSymbol}">AAPL</div>
                </div>
                <div class="mb-2">
                    <div class="muted">Current Price</div>
                    <div class="h1" th:text="${currentPrice != null ? #numbers.formatDecimal(currentPrice, 1, 'POINT', 2, 'POINT') : '‚Äî'}">‚Äî</div>
                </div>
                <div th:if="${currentPosition != null}">
                    <div class="muted">Your Position</div>
                    <div style="display:flex; gap:16px; margin-top:6px;">
                        <div>
                            <div class="muted">Quantity</div>
                            <div class="h2" th:text="${#numbers.formatDecimal(currentPosition.quantity, 1, 'POINT', 0, 'POINT')}">0</div>
                        </div>
                        <div>
                            <div class="muted">Avg Price</div>
                            <div class="h2" th:text="${#numbers.formatDecimal(currentPosition.averagePrice, 1, 'POINT', 2, 'POINT')}">$0.00</div>
                        </div>
                    </div>
                </div>
                <div th:if="${currentPosition == null}" class="muted" style="margin-top: 8px;">Select a symbol to see your holdings and live price.</div>
            </div>
        </div>

        <div class="card mt-4" style="background: linear-gradient(135deg, rgba(72, 187, 120, 0.05), rgba(56, 161, 105, 0.05)); border-color: rgba(72, 187, 120, 0.3);">
            <h3 class="h2 mb-2">üí° Trading Tips</h3>
            <ul style="margin: 0; padding-left: 24px; color: var(--text-secondary);">
                <li style="margin-bottom: 8px;">Research the company before investing</li>
                <li style="margin-bottom: 8px;">Diversify your portfolio across different sectors</li>
                <li style="margin-bottom: 8px;">Consider your risk tolerance and investment timeline</li>
                <li>Never invest more than you can afford to lose</li>
            </ul>
        </div>
    </section>
</div>

